import{C as ye}from"./vendor.633d146a.js";const Le=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}};Le();function be(e,t){if(e<1)return;const o=e*2;let i=Math.ceil(Math.sqrt(o)),n,s;for(let c=i;c<=t;c++)if(o%c==0){n=c,s=o/c;break}if(!n){i=Math.floor(Math.sqrt(o)),i>t&&(i=t);for(let c=i;c>1;c--)if(o%c==0){n=c,s=o/c;break}}return n||(n=e,s=2),n>t&&([n,s]=[s,n]),{rows:s,cols:n}}const G=sessionStorage;function A(){const e={};for(let t=0;t<15;t++)e[t]=`./images/default/${t}.jpg`;return e}function Ee(){return{cardSize:10,dynamic:!1,images:A()}}function Se(e){G.setItem("config",JSON.stringify(e))}function x(){const e=G.getItem("config");return e?JSON.parse(e):Ee()}const g=document.querySelector(".image-editor"),B=document.querySelector(".controls .close-btn"),R=document.querySelector(".controls .accept-btn"),we=document.querySelector(".resizer"),U=new ye(we,{showZoomer:!0,mouseWheelZoom:"ctrl"}),ke=new CustomEvent("close",{detail:{},bubbles:!1,cancelable:!1,composed:!1}),F=new CustomEvent("confirm",{detail:{},bubbles:!1,cancelable:!1,composed:!1});function V(){U.result("blob").then(e=>{const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{F.detail.image=t.result,W(),g.dispatchEvent(F)}})}function J(){return g.classList.contains("open")}function qe(){g.classList.add("open"),$e()}function W(){g.classList.remove("open"),Ce()}function $e(){B.addEventListener("click",C),R.addEventListener("click",V)}function Ce(){B.removeEventListener("click",C),R.removeEventListener("click",V)}function ze(e){if(J())return;const t=new FileReader;t.onload=o=>{U.bind({url:o.target.result}).then(()=>{qe()})},t.readAsDataURL(e)}function C(){!J()||(W(),g.dispatchEvent(ke))}const v=document.querySelector(".menu .new-game"),Z=document.querySelector(".menu .new-game .close-btn"),H=document.querySelector(".menu .new-game .accept-btn"),z=document.querySelector("#size"),M=document.querySelector("#mode"),K=document.querySelector(".file"),h=document.querySelector("#upload"),Q=document.querySelector(".image-editor"),m=document.querySelector(".cards");let r;const X=9,Y=500;m.style.setProperty("--delete-time",`${Y/1e3}s`);const Me=new CustomEvent("close",{detail:{},bubbles:!1,cancelable:!1,composed:!1}),_=new CustomEvent("confirm",{detail:{},bubbles:!1,cancelable:!1,composed:!1});function ee(){document.querySelector("#upload").click(),h.addEventListener("change",oe)}function te(e){r.cardSize=Number(e.target.value)+X,m.style.setProperty("--size",`${r.cardSize}vh`)}function ne(e){r.dynamic=e.target.checked}function Te(e,t){delete r.images[e],m.removeChild(t),Object.keys(r.images).length===0&&(r.images=A(),le())}function oe(){h.removeEventListener("change",oe),h.files&&h.files[0]&&(ze(h.files[0]),Q.addEventListener("confirm",se))}function se(e){Q.removeEventListener("confirm",se);const t=new Date().getTime();r.images[t]=e.detail.image,m.appendChild(ae(t,e.detail.image))}function ce(){Se(r),_.detail.config=r,re(),v.dispatchEvent(_)}function ie(){return v.classList.contains("open")}function De(){r=x(),m.style.setProperty("--size",`${r.cardSize}vh`),z.value=r.cardSize-X,M.checked=r.dynamic,le(),v.classList.add("open"),Ie()}function re(){C(),Oe(),Pe(),v.classList.remove("open")}function Ie(){K.addEventListener("click",ee),z.addEventListener("change",te),M.addEventListener("change",ne),Z.addEventListener("click",T),H.addEventListener("click",ce)}function Oe(){K.removeEventListener("click",ee),z.removeEventListener("change",te),M.removeEventListener("change",ne),Z.removeEventListener("click",T),H.removeEventListener("click",ce)}function ae(e,t){const o=document.createElement("div");o.classList.add("card"),o.dataset.id=e;const i=document.createElement("img");i.classList.add("thumbnail"),i.src=t,i.alt=`Image ${e}`;const n=document.createElement("img");n.classList.add("delete"),n.src="./images/icons/btn-delete.svg",n.alt=`Delete Image ${e}`,n.addEventListener("touchstart",u=>u.preventDefault()),n.addEventListener("touchend",u=>u.preventDefault()),o.appendChild(i),o.appendChild(n);let s;const c=()=>{s&&(clearTimeout(s),s=void 0),o.classList.contains("deleting")&&o.classList.remove("deleting")},d=()=>{c(),o.classList.contains("deleting")||o.classList.add("deleting"),s=setTimeout(()=>{Te(e,o)},Y)};return o.addEventListener("pointerdown",d),o.addEventListener("pointerup",c),o}function le(){Object.keys(r.images).forEach(t=>{m.appendChild(ae(t,r.images[t]))})}function Pe(){const e=m.querySelectorAll(".card");for(let t=e.length-1;t>=0;t--)e[t].remove()}function Ne(){ie()||De()}function T(){!ie()||(re(),v.dispatchEvent(Me))}const y=document.querySelector(".menu img"),E=document.querySelector(".menu .new-game"),de=document.querySelector(".viewport");function S(){T(),E.removeEventListener("close",S),E.removeEventListener("confirm",S),y.classList.remove("closed"),de.classList.remove("pause"),y.addEventListener("click",D)}function D(){y.removeEventListener("click",D),y.classList.add("closed"),de.classList.add("pause"),Ne(),E.addEventListener("close",S),E.addEventListener("confirm",S)}y.addEventListener("click",D);const f=document.querySelector(":root"),L=document.querySelector(".viewport"),w=document.querySelector(".game"),I=document.querySelector(".game-over"),O=.25,l=500;let b=16,k=10,ue=!1,P=0,p=!1,a,me,q,$;const fe=()=>k*.1,je=()=>({width:L.clientWidth,height:L.clientHeight});function N(){const{width:e,height:t}=je(),o=t*(k/100),i=Math.floor(e/(o+o*O)),n=be(b,i)||{cols:1,rows:1},s=n.cols*o+n.cols*o*O,c=(e-s)/2,d=n.rows*o+n.rows*o*O,u=t>d?(t-d)/2:t*(fe()/100);f.style.setProperty("--cols",n.cols),f.style.setProperty("--rows",n.rows),f.style.setProperty("--size",`${k}vh`),f.style.setProperty("--gap",`${fe()}vh`),f.style.setProperty("--ml",`${c}px`),f.style.setProperty("--mt",`${u}px`)}function pe(e){const t=e.querySelector(".back");t.removeEventListener("click",j),t.classList.add("flip"),setTimeout(()=>{e.querySelector(".front").classList.add("flip")},l/2)}function ge(e){const t=e.querySelector(".back");e.querySelector(".front").classList.remove("flip"),setTimeout(()=>{t.classList.remove("flip")},l/2),setTimeout(()=>{t.addEventListener("click",j)},l)}function ve(){L.classList.add("pause");const e=new Date-me,t=Math.floor(e/6e4),o=Math.floor((e-t*6e4)/1e3);document.querySelector(".game-over .time").textContent=`\u23F3\uFE0F ${t}:${o<10?"0":""}${o}`,document.querySelector(".game-over .match span").textContent=q,document.querySelector(".game-over .fails span").textContent=$,document.querySelector(".game-over .ratio span").textContent=Math.round(q/$*10)/10,I.classList.add("open")}function Ge(e){setTimeout(()=>{e.classList.add("remove"),a.classList.add("remove"),setTimeout(()=>{e.remove(),a.remove(),b-=1,b>0?(N(),a=void 0,p=!1):ve()},l)},l)}function Ae(){P+=1,P<b?(p=!1,a=void 0):ve()}function xe(e){q+=1,setTimeout(()=>{ue?Ge(e):Ae()},l)}function Be(e){$+=1,setTimeout(()=>{ge(e),ge(a),setTimeout(()=>{p=!1,a=void 0},l)},l*1.5)}function Re(e){pe(e),a=e}function Ue(e){p=!0,pe(e),e.dataset.id===a.dataset.id?xe(e):Be(e)}function j(e){if(p)return;const t=e.target.parentNode;a?t!==a&&Ue(t):Re(t)}function Fe(e,t,o){const i=document.createElement("div");i.classList.add("card"),i.dataset.id=e;const n=document.createElement("img");n.classList.add("back"),n.src=t,n.alt="Card",n.addEventListener("click",j);const s=document.createElement("img");return s.classList.add("front"),s.src=o,s.alt=`Card ${e}`,i.appendChild(n),i.appendChild(s),i}function he(e){for(;w.lastChild;)w.removeChild(w.lastChild);L.classList.contains("pause")&&L.classList.remove("pause"),I.classList.contains("open")&&I.classList.remove("open");const t=e?e.detail.config:x();b=Object.keys(t.images).length,k=t.cardSize,ue=t.dynamic,P=0,p=!1,a=void 0,me=new Date,q=0,$=0;const o=`./images/backs/${Math.floor(Math.random()*9)}.jpg`;for(let i=0;i<2;i++){const n={};let s=Object.keys(t.images);for(s.forEach(c=>{n[c]=t.images[c]}),s=Object.keys(n);s.length>0;){const c=Math.floor(Math.random()*s.length),d=s[c],u=Fe(d,o,n[d]);w.appendChild(u),s.splice(c,1)}}N()}window.addEventListener("resize",N,!0);document.querySelector(".menu .new-game").addEventListener("confirm",he);f.style.setProperty("--flip-time",`${l/1e3}s`);he();
