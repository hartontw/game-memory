const x=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}};x();const y=sessionStorage;function h(){const e={};for(let t=0;t<15;t++)e[t]=`images/default/${t}.jpg`;return e}function H(){return{cardSize:10,dynamic:!1,images:h()}}function Q(e){y.setItem("config",JSON.stringify(e))}function X(){const e=y.getItem("config");return e?JSON.parse(e):H()}class Y{}const l=document.querySelector(".image-editor"),S=document.querySelector(".controls .close-btn"),w=document.querySelector(".controls .accept-btn"),_=document.querySelector(".resizer"),k=new Y(_,{showZoomer:!0,mouseWheelZoom:"ctrl"}),ee=new CustomEvent("close",{detail:{},bubbles:!1,cancelable:!1,composed:!1}),q=new CustomEvent("confirm",{detail:{},bubbles:!1,cancelable:!1,composed:!1});function $(){k.result("blob").then(e=>{const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{q.detail.image=t.result,z(),l.dispatchEvent(q)}})}function C(){return l.classList.contains("open")}function te(){l.classList.add("open"),ne()}function z(){l.classList.remove("open"),oe()}function ne(){S.addEventListener("click",v),w.addEventListener("click",$)}function oe(){S.removeEventListener("click",v),w.removeEventListener("click",$)}function ce(e){if(C())return;const t=new FileReader;t.onload=o=>{k.bind({url:o.target.result}).then(()=>{te()})},t.readAsDataURL(e)}function v(){!C()||(z(),l.dispatchEvent(ee))}const d=document.querySelector(".menu .new-game"),I=document.querySelector(".menu .new-game .close-btn"),D=document.querySelector(".menu .new-game .accept-btn"),p=document.querySelector("#size"),L=document.querySelector("#mode"),O=document.querySelector(".file"),u=document.querySelector("#upload"),N=document.querySelector(".image-editor"),r=document.querySelector(".cards");let s;const A=9,G=500;r.style.setProperty("--delete-time",`${G/1e3}s`);const se=new CustomEvent("close",{detail:{},bubbles:!1,cancelable:!1,composed:!1}),P=new CustomEvent("confirm",{detail:{},bubbles:!1,cancelable:!1,composed:!1});function T(){document.querySelector("#upload").click(),u.addEventListener("change",U)}function B(e){s.cardSize=Number(e.target.value)+A,r.style.setProperty("--size",`${s.cardSize}vh`)}function R(e){s.dynamic=e.target.checked}function ie(e,t){delete s.images[e],r.removeChild(t),Object.keys(s.images).length===0&&(s.images=h(),Z())}function U(){u.removeEventListener("change",U),u.files&&u.files[0]&&(ce(u.files[0]),N.addEventListener("confirm",j))}function j(e){N.removeEventListener("confirm",j);const t=new Date().getTime();s.images[t]=e.detail.image,r.appendChild(V(t,e.detail.image))}function F(){Q(s),P.detail.config=s,M(),d.dispatchEvent(P)}function J(){return d.classList.contains("open")}function re(){s=X(),r.style.setProperty("--size",`${s.cardSize}vh`),p.value=s.cardSize-A,L.checked=s.dynamic,Z(),d.classList.add("open"),ae()}function M(){v(),le(),de(),d.classList.remove("open")}function ae(){O.addEventListener("click",T),p.addEventListener("change",B),L.addEventListener("change",R),I.addEventListener("click",b),D.addEventListener("click",F)}function le(){O.removeEventListener("click",T),p.removeEventListener("change",B),L.removeEventListener("change",R),I.removeEventListener("click",b),D.removeEventListener("click",F)}function V(e,t){const o=document.createElement("div");o.classList.add("card"),o.dataset.id=e;const i=document.createElement("img");i.classList.add("thumbnail"),i.src=t,i.alt=`Image ${e}`;const n=document.createElement("img");n.classList.add("delete"),n.src="images/icons/btn-delete.svg",n.alt=`Delete Image ${e}`,o.appendChild(i),o.appendChild(n);let c;const a=()=>{c&&(clearTimeout(c),c=void 0),o.classList.contains("deleting")&&o.classList.remove("deleting")},W=()=>{a(),o.classList.contains("deleting")||o.classList.add("deleting"),c=setTimeout(()=>{ie(e,o)},G)};return o.addEventListener("mousedown",W),o.addEventListener("mouseup",a),o}function Z(){Object.keys(s.images).forEach(t=>{r.appendChild(V(t,s.images[t]))})}function de(){const e=r.querySelectorAll(".card");for(let t=e.length-1;t>=0;t--)e[t].remove()}function ue(){J()||re()}function b(){!J()||(M(),d.dispatchEvent(se))}const m=document.querySelector(".menu img"),f=document.querySelector(".menu .new-game"),K=document.querySelector(".viewport");function g(){b(),f.removeEventListener("close",g),f.removeEventListener("confirm",g),m.classList.remove("closed"),K.classList.remove("pause"),m.addEventListener("click",E)}function E(){m.removeEventListener("click",E),m.classList.add("closed"),K.classList.add("pause"),ue(),f.addEventListener("close",g),f.addEventListener("confirm",g)}m.addEventListener("click",E);
