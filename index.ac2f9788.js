import{C as he}from"./vendor.633d146a.js";const ye=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}};ye();function Le(e,t){if(e<1)return;const o=e*2;let i=Math.ceil(Math.sqrt(o)),n,s;for(let c=i;c<=t;c++)if(o%c==0){n=c,s=o/c;break}if(!n){i=Math.floor(Math.sqrt(o)),i>t&&(i=t);for(let c=i;c>1;c--)if(o%c==0){n=c,s=o/c;break}}return n||(n=e,s=2),n>t&&([n,s]=[s,n]),{rows:s,cols:n}}const G=sessionStorage;function A(){const e={};for(let t=0;t<15;t++)e[t]=`./images/default/${t}.jpg`;return e}function be(){return{cardSize:10,dynamic:!1,images:A()}}function Ee(e){G.setItem("config",JSON.stringify(e))}function B(){const e=G.getItem("config");return e?JSON.parse(e):be()}const p=document.querySelector(".image-editor"),R=document.querySelector(".controls .close-btn"),U=document.querySelector(".controls .accept-btn"),Se=document.querySelector(".resizer"),x=new he(Se,{showZoomer:!0,mouseWheelZoom:"ctrl"}),we=new CustomEvent("close",{detail:{},bubbles:!1,cancelable:!1,composed:!1}),F=new CustomEvent("confirm",{detail:{},bubbles:!1,cancelable:!1,composed:!1});function V(){x.result("blob").then(e=>{const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{F.detail.image=t.result,W(),p.dispatchEvent(F)}})}function J(){return p.classList.contains("open")}function ke(){p.classList.add("open"),qe()}function W(){p.classList.remove("open"),$e()}function qe(){R.addEventListener("click",C),U.addEventListener("click",V)}function $e(){R.removeEventListener("click",C),U.removeEventListener("click",V)}function Ce(e){if(J())return;const t=new FileReader;t.onload=o=>{x.bind({url:o.target.result}).then(()=>{ke()})},t.readAsDataURL(e)}function C(){!J()||(W(),p.dispatchEvent(we))}const g=document.querySelector(".menu .new-game"),Z=document.querySelector(".menu .new-game .close-btn"),H=document.querySelector(".menu .new-game .accept-btn"),z=document.querySelector("#size"),T=document.querySelector("#mode"),K=document.querySelector(".file"),v=document.querySelector("#upload"),Q=document.querySelector(".image-editor"),u=document.querySelector(".cards");let r;const X=9,Y=500;u.style.setProperty("--delete-time",`${Y/1e3}s`);const ze=new CustomEvent("close",{detail:{},bubbles:!1,cancelable:!1,composed:!1}),_=new CustomEvent("confirm",{detail:{},bubbles:!1,cancelable:!1,composed:!1});function ee(){document.querySelector("#upload").click(),v.addEventListener("change",se)}function te(e){r.cardSize=Number(e.target.value)+X,u.style.setProperty("--size",`${r.cardSize}vh`)}function ne(e){r.dynamic=e.target.checked}function Te(e,t){delete r.images[e],u.removeChild(t),Object.keys(r.images).length===0&&(r.images=A(),le())}function se(){v.removeEventListener("change",se),v.files&&v.files[0]&&(Ce(v.files[0]),Q.addEventListener("confirm",oe))}function oe(e){Q.removeEventListener("confirm",oe);const t=new Date().getTime();r.images[t]=e.detail.image,u.appendChild(ae(t,e.detail.image))}function ce(){Ee(r),_.detail.config=r,re(),g.dispatchEvent(_)}function ie(){return g.classList.contains("open")}function Me(){r=B(),u.style.setProperty("--size",`${r.cardSize}vh`),z.value=r.cardSize-X,T.checked=r.dynamic,le(),g.classList.add("open"),Ie()}function re(){C(),Oe(),Pe(),g.classList.remove("open")}function Ie(){K.addEventListener("click",ee),z.addEventListener("change",te),T.addEventListener("change",ne),Z.addEventListener("click",M),H.addEventListener("click",ce)}function Oe(){K.removeEventListener("click",ee),z.removeEventListener("change",te),T.removeEventListener("change",ne),Z.removeEventListener("click",M),H.removeEventListener("click",ce)}function ae(e,t){const o=document.createElement("div");o.classList.add("card"),o.dataset.id=e;const i=document.createElement("img");i.classList.add("thumbnail"),i.src=t,i.alt=`Image ${e}`;const n=document.createElement("img");n.classList.add("delete"),n.src="./images/icons/btn-delete.svg",n.alt=`Delete Image ${e}`,o.appendChild(i),o.appendChild(n);let s;const c=()=>{s&&(clearTimeout(s),s=void 0),o.classList.contains("deleting")&&o.classList.remove("deleting")},d=()=>{c(),o.classList.contains("deleting")||o.classList.add("deleting"),s=setTimeout(()=>{Te(e,o)},Y)};return o.addEventListener("mousedown",d),o.addEventListener("mouseup",c),o}function le(){Object.keys(r.images).forEach(t=>{u.appendChild(ae(t,r.images[t]))})}function Pe(){const e=u.querySelectorAll(".card");for(let t=e.length-1;t>=0;t--)e[t].remove()}function De(){ie()||Me()}function M(){!ie()||(re(),g.dispatchEvent(ze))}const h=document.querySelector(".menu img"),b=document.querySelector(".menu .new-game"),de=document.querySelector(".viewport");function E(){M(),b.removeEventListener("close",E),b.removeEventListener("confirm",E),h.classList.remove("closed"),de.classList.remove("pause"),h.addEventListener("click",I)}function I(){h.removeEventListener("click",I),h.classList.add("closed"),de.classList.add("pause"),De(),b.addEventListener("close",E),b.addEventListener("confirm",E)}h.addEventListener("click",I);const m=document.querySelector(":root"),y=document.querySelector(".viewport"),S=document.querySelector(".game"),O=document.querySelector(".game-over"),P=.25,l=1e3;let L=16,w=10,ue=!1,D=0,f=!1,a,k,q;const me=()=>w*.1,Ne=()=>({width:y.clientWidth,height:y.clientHeight});function N(){const{width:e,height:t}=Ne(),o=t*(w/100),i=Math.floor(e/(o+o*P)),n=Le(L,i)||{cols:1,rows:1},s=n.cols*o+n.cols*o*P,c=(e-s)/2,d=n.rows*o+n.rows*o*P,$=t>d?(t-d)/2:t*(me()/100);m.style.setProperty("--cols",n.cols),m.style.setProperty("--rows",n.rows),m.style.setProperty("--size",`${w}vh`),m.style.setProperty("--gap",`${me()}vh`),m.style.setProperty("--ml",`${c}px`),m.style.setProperty("--mt",`${$}px`)}function fe(e){const t=e.querySelector(".back");t.removeEventListener("click",j),t.classList.add("flip"),setTimeout(()=>{e.querySelector(".front").classList.add("flip")},l/2)}function pe(e){const t=e.querySelector(".back");e.querySelector(".front").classList.remove("flip"),setTimeout(()=>{t.classList.remove("flip")},l/2),setTimeout(()=>{t.addEventListener("click",j)},l)}function ge(){y.classList.add("pause"),document.querySelector(".game-over .match span").textContent=k,document.querySelector(".game-over .fails span").textContent=q,document.querySelector(".game-over .ratio span").textContent=Math.round(k/q*10)/10,O.classList.add("open")}function je(e){setTimeout(()=>{e.classList.add("remove"),a.classList.add("remove"),setTimeout(()=>{e.remove(),a.remove(),L-=1,L>0?(N(),a=void 0,f=!1):ge()},l)},l)}function Ge(){D+=1,D<L?(f=!1,a=void 0):ge()}function Ae(e){k+=1,setTimeout(()=>{ue?je(e):Ge()},l)}function Be(e){q+=1,setTimeout(()=>{pe(e),pe(a),setTimeout(()=>{f=!1,a=void 0},l)},l*1.5)}function Re(e){fe(e),a=e}function Ue(e){f=!0,fe(e),e.dataset.id===a.dataset.id?Ae(e):Be(e)}function j(e){if(f)return;const t=e.target.parentNode;a?t!==a&&Ue(t):Re(t)}function xe(e,t,o){const i=document.createElement("div");i.classList.add("card"),i.dataset.id=e;const n=document.createElement("img");n.classList.add("back"),n.src=t,n.alt="Card",n.addEventListener("click",j);const s=document.createElement("img");return s.classList.add("front"),s.src=o,s.alt=`Card ${e}`,i.appendChild(n),i.appendChild(s),i}function ve(e){for(;S.lastChild;)S.removeChild(S.lastChild);y.classList.contains("pause")&&y.classList.remove("pause"),O.classList.contains("open")&&O.classList.remove("open");const t=e?e.detail.config:B();L=Object.keys(t.images).length,w=t.cardSize,ue=t.dynamic,D=0,f=!1,a=void 0,k=0,q=0;const o=`./images/backs/${Math.floor(Math.random()*9)}.jpg`;for(let i=0;i<2;i++){const n={};let s=Object.keys(t.images);for(s.forEach(c=>{n[c]=t.images[c]}),s=Object.keys(n);s.length>0;){const c=Math.floor(Math.random()*s.length),d=s[c],$=xe(d,o,n[d]);S.appendChild($),s.splice(c,1)}}N()}window.addEventListener("resize",N,!0);document.querySelector(".menu .new-game").addEventListener("confirm",ve);m.style.setProperty("--flip-time",`${l/1e3}s`);ve();
