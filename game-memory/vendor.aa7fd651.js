var Te=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},K={exports:{}};(function(B,re){(function(D,F){typeof re.nodeName!="string"?B.exports=F():D.Croppie=F()})(typeof self!="undefined"?self:Te,function(){if(typeof Promise!="function"){/*! promise-polyfill 3.1.0 */(function(e){function n(a,c){return function(){a.apply(c,arguments)}}function t(a){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof a!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],d(a,n(r,this),n(o,this))}function i(a){var c=this;return this._state===null?void this._deferreds.push(a):void p(function(){var l=c._state?a.onFulfilled:a.onRejected;if(l===null)return void(c._state?a.resolve:a.reject)(c._value);var h;try{h=l(c._value)}catch(m){return void a.reject(m)}a.resolve(h)})}function r(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&(typeof a=="object"||typeof a=="function")){var c=a.then;if(typeof c=="function")return void d(n(c,a),n(r,this),n(o,this))}this._state=!0,this._value=a,s.call(this)}catch(l){o.call(this,l)}}function o(a){this._state=!1,this._value=a,s.call(this)}function s(){for(var a=0,c=this._deferreds.length;c>a;a++)i.call(this,this._deferreds[a]);this._deferreds=null}function u(a,c,l,h){this.onFulfilled=typeof a=="function"?a:null,this.onRejected=typeof c=="function"?c:null,this.resolve=l,this.reject=h}function d(a,c,l){var h=!1;try{a(function(m){h||(h=!0,c(m))},function(m){h||(h=!0,l(m))})}catch(m){if(h)return;h=!0,l(m)}}var f=setTimeout,p=typeof setImmediate=="function"&&setImmediate||function(a){f(a,1)},v=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};t.prototype.catch=function(a){return this.then(null,a)},t.prototype.then=function(a,c){var l=this;return new t(function(h,m){i.call(l,new u(a,c,h,m))})},t.all=function(){var a=Array.prototype.slice.call(arguments.length===1&&v(arguments[0])?arguments[0]:arguments);return new t(function(c,l){function h(w,y){try{if(y&&(typeof y=="object"||typeof y=="function")){var _=y.then;if(typeof _=="function")return void _.call(y,function(C){h(w,C)},l)}a[w]=y,--m==0&&c(a)}catch(C){l(C)}}if(a.length===0)return c([]);for(var m=a.length,g=0;g<a.length;g++)h(g,a[g])})},t.resolve=function(a){return a&&typeof a=="object"&&a.constructor===t?a:new t(function(c){c(a)})},t.reject=function(a){return new t(function(c,l){l(a)})},t.race=function(a){return new t(function(c,l){for(var h=0,m=a.length;m>h;h++)a[h].then(c,l)})},t._setImmediateFn=function(a){p=a},B.exports?B.exports=t:e.Promise||(e.Promise=t)})(this)}typeof window!="undefined"&&typeof window.CustomEvent!="function"&&function(){function e(n,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}(),typeof HTMLCanvasElement!="undefined"&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,n,t){for(var i=atob(this.toDataURL(n,t).split(",")[1]),r=i.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=i.charCodeAt(s);e(new Blob([o],{type:n||"image/png"}))}});var D=["Webkit","Moz","ms"],F=typeof document!="undefined"?document.createElement("div").style:{},Q=[1,8,3,6],ae=[2,7,4,5],Z,R,S;function k(e){if(e in F)return e;for(var n=e[0].toUpperCase()+e.slice(1),t=D.length;t--;)if(e=D[t]+n,e in F)return e}R=k("transform"),Z=k("transformOrigin"),S=k("userSelect");function le(e,n){var t=Q.indexOf(e)>-1?Q:ae,i=t.indexOf(e),r=n/90%t.length;return t[(t.length+i+r%t.length)%t.length]}function Y(e,n){e=e||{};for(var t in n)n[t]&&n[t].constructor&&n[t].constructor===Object?(e[t]=e[t]||{},Y(e[t],n[t])):e[t]=n[t];return e}function N(e){return Y({},e)}function se(e,n,t){var i;return function(){var r=this,o=arguments,s=function(){i=null,t||e.apply(r,o)},u=t&&!i;clearTimeout(i),i=setTimeout(s,n),u&&e.apply(r,o)}}function P(e){if("createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!0),e.dispatchEvent(n)}else e.fireEvent("onchange")}function b(e,n,t){if(typeof n=="string"){var i=n;n={},n[i]=t}for(var r in n)e.style[r]=n[r]}function E(e,n){e.classList?e.classList.add(n):e.className+=" "+n}function ue(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(n,"")}function J(e,n){for(var t in n)e.setAttribute(t,n[t])}function M(e){return parseInt(e,10)}function ce(e,n){if(!e)throw"Source image missing";var t=new Image;return t.style.opacity="0",new Promise(function(i,r){function o(){t.style.opacity="1",setTimeout(function(){i(t)},1)}t.removeAttribute("crossOrigin"),e.match(/^https?:\/\/|^\/\//)&&t.setAttribute("crossOrigin","anonymous"),t.onload=function(){n?EXIF.getData(t,function(){o()}):o()},t.onerror=function(s){t.style.opacity=1,setTimeout(function(){r(s)},1)},t.src=e})}function $(e,n){var t=e.naturalWidth,i=e.naturalHeight,r=n||j(e);if(r&&r>=5){var o=t;t=i,i=o}return{width:t,height:i}}var he={translate3d:{suffix:", 0px"},translate:{suffix:""}},x=function(e,n,t){this.x=parseFloat(e),this.y=parseFloat(n),this.scale=parseFloat(t)};x.parse=function(e){return e.style?x.parse(e.style[R]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?x.fromMatrix(e):x.fromString(e)},x.fromMatrix=function(e){var n=e.substring(7).split(",");return(!n.length||e==="none")&&(n=[1,0,0,1,0,0]),new x(M(n[4]),M(n[5]),parseFloat(n[0]))},x.fromString=function(e){var n=e.split(") "),t=n[0].substring(L.globals.translate.length+1).split(","),i=n.length>1?n[1].substring(6):1,r=t.length>1?t[0]:0,o=t.length>1?t[1]:0;return new x(r,o,i)},x.prototype.toString=function(){var e=he[L.globals.translate].suffix||"";return L.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var H=function(e){if(!e||!e.style[Z]){this.x=0,this.y=0;return}var n=e.style[Z].split(" ");this.x=parseFloat(n[0]),this.y=parseFloat(n[1])};H.prototype.toString=function(){return this.x+"px "+this.y+"px"};function j(e){return e.exifdata&&e.exifdata.Orientation?M(e.exifdata.Orientation):1}function ee(e,n,t){var i=n.width,r=n.height,o=e.getContext("2d");switch(e.width=n.width,e.height=n.height,o.save(),t){case 2:o.translate(i,0),o.scale(-1,1);break;case 3:o.translate(i,r),o.rotate(180*Math.PI/180);break;case 4:o.translate(0,r),o.scale(1,-1);break;case 5:e.width=r,e.height=i,o.rotate(90*Math.PI/180),o.scale(1,-1);break;case 6:e.width=r,e.height=i,o.rotate(90*Math.PI/180),o.translate(0,-r);break;case 7:e.width=r,e.height=i,o.rotate(-90*Math.PI/180),o.translate(-i,r),o.scale(1,-1);break;case 8:e.width=r,e.height=i,o.translate(0,i),o.rotate(-90*Math.PI/180);break}o.drawImage(n,0,0,i,r),o.restore()}function fe(){var e=this,n="croppie-container",t=e.options.viewport.type?"cr-vp-"+e.options.viewport.type:null,i,r,o,s,u,d;e.options.useCanvas=e.options.enableOrientation||U.call(e),e.data={},e.elements={},i=e.elements.boundary=document.createElement("div"),o=e.elements.viewport=document.createElement("div"),r=e.elements.img=document.createElement("img"),s=e.elements.overlay=document.createElement("div"),e.options.useCanvas?(e.elements.canvas=document.createElement("canvas"),e.elements.preview=e.elements.canvas):e.elements.preview=r,E(i,"cr-boundary"),i.setAttribute("aria-dropeffect","none"),u=e.options.boundary.width,d=e.options.boundary.height,b(i,{width:u+(isNaN(u)?"":"px"),height:d+(isNaN(d)?"":"px")}),E(o,"cr-viewport"),t&&E(o,t),b(o,{width:e.options.viewport.width+"px",height:e.options.viewport.height+"px"}),o.setAttribute("tabindex",0),E(e.elements.preview,"cr-image"),J(e.elements.preview,{alt:"preview","aria-grabbed":"false"}),E(s,"cr-overlay"),e.element.appendChild(i),i.appendChild(e.elements.preview),i.appendChild(o),i.appendChild(s),E(e.element,n),e.options.customClass&&E(e.element,e.options.customClass),ge.call(this),e.options.enableZoom&&pe.call(e),e.options.enableResize&&de.call(e)}function U(){return this.options.enableExif&&window.EXIF}function de(){var e=this,n=document.createElement("div"),t=!1,i,r,o,s=50,u,d,f,p;E(n,"cr-resizer"),b(n,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(f=document.createElement("div"),E(f,"cr-resizer-vertical"),n.appendChild(f)),this.options.resizeControls.width&&(p=document.createElement("div"),E(p,"cr-resizer-horisontal"),n.appendChild(p));function v(l){if(!(l.button!==void 0&&l.button!==0)&&(l.preventDefault(),!t)){var h=e.elements.overlay.getBoundingClientRect();if(t=!0,r=l.pageX,o=l.pageY,i=l.currentTarget.className.indexOf("vertical")!==-1?"v":"h",u=h.width,d=h.height,l.touches){var m=l.touches[0];r=m.pageX,o=m.pageY}window.addEventListener("mousemove",a),window.addEventListener("touchmove",a),window.addEventListener("mouseup",c),window.addEventListener("touchend",c),document.body.style[S]="none"}}function a(l){var h=l.pageX,m=l.pageY;if(l.preventDefault(),l.touches){var g=l.touches[0];h=g.pageX,m=g.pageY}var w=h-r,y=m-o,_=e.options.viewport.height+y,C=e.options.viewport.width+w;i==="v"&&_>=s&&_<=d?(b(n,{height:_+"px"}),e.options.boundary.height+=y,b(e.elements.boundary,{height:e.options.boundary.height+"px"}),e.options.viewport.height+=y,b(e.elements.viewport,{height:e.options.viewport.height+"px"})):i==="h"&&C>=s&&C<=u&&(b(n,{width:C+"px"}),e.options.boundary.width+=w,b(e.elements.boundary,{width:e.options.boundary.width+"px"}),e.options.viewport.width+=w,b(e.elements.viewport,{width:e.options.viewport.width+"px"})),A.call(e),V.call(e),z.call(e),T.call(e),o=m,r=h}function c(){t=!1,window.removeEventListener("mousemove",a),window.removeEventListener("touchmove",a),window.removeEventListener("mouseup",c),window.removeEventListener("touchend",c),document.body.style[S]=""}f&&(f.addEventListener("mousedown",v),f.addEventListener("touchstart",v)),p&&(p.addEventListener("mousedown",v),p.addEventListener("touchstart",v)),this.elements.boundary.appendChild(n)}function O(e){if(this.options.enableZoom){var n=this.elements.zoomer,t=W(e,4);n.value=Math.max(parseFloat(n.min),Math.min(parseFloat(n.max),t)).toString()}}function pe(){var e=this,n=e.elements.zoomerWrap=document.createElement("div"),t=e.elements.zoomer=document.createElement("input");E(n,"cr-slider-wrap"),E(t,"cr-slider"),t.type="range",t.step="0.0001",t.value="1",t.style.display=e.options.showZoomer?"":"none",t.setAttribute("aria-label","zoom"),e.element.appendChild(n),n.appendChild(t),e._currentZoom=1;function i(){me.call(e,{value:parseFloat(t.value),origin:new H(e.elements.preview),viewportRect:e.elements.viewport.getBoundingClientRect(),transform:x.parse(e.elements.preview)})}function r(o){var s,u;if(e.options.mouseWheelZoom==="ctrl"&&o.ctrlKey!==!0)return 0;o.wheelDelta?s=o.wheelDelta/1200:o.deltaY?s=o.deltaY/1060:o.detail?s=o.detail/-60:s=0,u=e._currentZoom+s*e._currentZoom,o.preventDefault(),O.call(e,u),i.call(e)}e.elements.zoomer.addEventListener("input",i),e.elements.zoomer.addEventListener("change",i),e.options.mouseWheelZoom&&(e.elements.boundary.addEventListener("mousewheel",r),e.elements.boundary.addEventListener("DOMMouseScroll",r))}function me(e){var n=this,t=e?e.transform:x.parse(n.elements.preview),i=e?e.viewportRect:n.elements.viewport.getBoundingClientRect(),r=e?e.origin:new H(n.elements.preview);function o(){var f={};f[R]=t.toString(),f[Z]=r.toString(),b(n.elements.preview,f)}if(n._currentZoom=e?e.value:n._currentZoom,t.scale=n._currentZoom,n.elements.zoomer.setAttribute("aria-valuenow",n._currentZoom),o(),n.options.enforceBoundary){var s=ve.call(n,i),u=s.translate,d=s.origin;t.x>=u.maxX&&(r.x=d.minX,t.x=u.maxX),t.x<=u.minX&&(r.x=d.maxX,t.x=u.minX),t.y>=u.maxY&&(r.y=d.minY,t.y=u.maxY),t.y<=u.minY&&(r.y=d.maxY,t.y=u.minY)}o(),we.call(n),T.call(n)}function ve(e){var n=this,t=n._currentZoom,i=e.width,r=e.height,o=n.elements.boundary.clientWidth/2,s=n.elements.boundary.clientHeight/2,u=n.elements.preview.getBoundingClientRect(),d=u.width,f=u.height,p=i/2,v=r/2,a=(p/t-o)*-1,c=a-(d*(1/t)-i*(1/t)),l=(v/t-s)*-1,h=l-(f*(1/t)-r*(1/t)),m=1/t*p,g=d*(1/t)-m,w=1/t*v,y=f*(1/t)-w;return{translate:{maxX:a,minX:c,maxY:l,minY:h},origin:{maxX:g,minX:m,maxY:y,minY:w}}}function z(e){var n=this,t=n._currentZoom,i=n.elements.preview.getBoundingClientRect(),r=n.elements.viewport.getBoundingClientRect(),o=x.parse(n.elements.preview.style[R]),s=new H(n.elements.preview),u=r.top-i.top+r.height/2,d=r.left-i.left+r.width/2,f={},p={};if(e){var v=s.x,a=s.y,c=o.x,l=o.y;f.y=v,f.x=a,o.y=c,o.x=l}else f.y=u/t,f.x=d/t,p.y=(f.y-s.y)*(1-t),p.x=(f.x-s.x)*(1-t),o.x-=p.x,o.y-=p.y;var h={};h[Z]=f.x+"px "+f.y+"px",h[R]=o.toString(),b(n.elements.preview,h)}function ge(){var e=this,n=!1,t,i,r,o,s;function u(l,h){var m=e.elements.preview.getBoundingClientRect(),g=s.y+h,w=s.x+l;e.options.enforceBoundary?(o.top>m.top+h&&o.bottom<m.bottom+h&&(s.y=g),o.left>m.left+l&&o.right<m.right+l&&(s.x=w)):(s.y=g,s.x=w)}function d(l){e.elements.preview.setAttribute("aria-grabbed",l),e.elements.boundary.setAttribute("aria-dropeffect",l?"move":"none")}function f(l){var h=37,m=38,g=39,w=40;if(l.shiftKey&&(l.keyCode===m||l.keyCode===w)){var y;l.keyCode===m?y=parseFloat(e.elements.zoomer.value)+parseFloat(e.elements.zoomer.step):y=parseFloat(e.elements.zoomer.value)-parseFloat(e.elements.zoomer.step),e.setZoom(y)}else if(e.options.enableKeyMovement&&l.keyCode>=37&&l.keyCode<=40){l.preventDefault();var _=C(l.keyCode);s=x.parse(e.elements.preview),document.body.style[S]="none",o=e.elements.viewport.getBoundingClientRect(),p(_)}function C(X){switch(X){case h:return[1,0];case m:return[0,1];case g:return[-1,0];case w:return[0,-1]}}}function p(l){var h=l[0],m=l[1],g={};u(h,m),g[R]=s.toString(),b(e.elements.preview,g),A.call(e),document.body.style[S]="",z.call(e),T.call(e),r=0}function v(l){if(!(l.button!==void 0&&l.button!==0)&&(l.preventDefault(),!n)){if(n=!0,t=l.pageX,i=l.pageY,l.touches){var h=l.touches[0];t=h.pageX,i=h.pageY}d(n),s=x.parse(e.elements.preview),window.addEventListener("mousemove",a),window.addEventListener("touchmove",a),window.addEventListener("mouseup",c),window.addEventListener("touchend",c),document.body.style[S]="none",o=e.elements.viewport.getBoundingClientRect()}}function a(l){l.preventDefault();var h=l.pageX,m=l.pageY;if(l.touches){var g=l.touches[0];h=g.pageX,m=g.pageY}var w=h-t,y=m-i,_={};if(l.type==="touchmove"&&l.touches.length>1){var C=l.touches[0],X=l.touches[1],oe=Math.sqrt((C.pageX-X.pageX)*(C.pageX-X.pageX)+(C.pageY-X.pageY)*(C.pageY-X.pageY));r||(r=oe/e._currentZoom);var Oe=oe/r;O.call(e,Oe),P(e.elements.zoomer);return}u(w,y),_[R]=s.toString(),b(e.elements.preview,_),A.call(e),i=m,t=h}function c(){n=!1,d(n),window.removeEventListener("mousemove",a),window.removeEventListener("touchmove",a),window.removeEventListener("mouseup",c),window.removeEventListener("touchend",c),document.body.style[S]="",z.call(e),T.call(e),r=0}e.elements.overlay.addEventListener("mousedown",v),e.elements.viewport.addEventListener("keydown",f),e.elements.overlay.addEventListener("touchstart",v)}function A(){if(!!this.elements){var e=this,n=e.elements.boundary.getBoundingClientRect(),t=e.elements.preview.getBoundingClientRect();b(e.elements.overlay,{width:t.width+"px",height:t.height+"px",top:t.top-n.top+"px",left:t.left-n.left+"px"})}}var we=se(A,500);function T(){var e=this,n=e.get();if(!!te.call(e))if(e.options.update.call(e,n),e.$&&typeof Prototype=="undefined")e.$(e.element).trigger("update.croppie",n);else{var t;window.CustomEvent?t=new CustomEvent("update",{detail:n}):(t=document.createEvent("CustomEvent"),t.initCustomEvent("update",!0,!0,n)),e.element.dispatchEvent(t)}}function te(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function q(){var e=this,n=1,t={},i=e.elements.preview,r,o=new x(0,0,n),s=new H,u=te.call(e);!u||e.data.bound||(e.data.bound=!0,t[R]=o.toString(),t[Z]=s.toString(),t.opacity=1,b(i,t),r=e.elements.preview.getBoundingClientRect(),e._originalImageWidth=r.width,e._originalImageHeight=r.height,e.data.orientation=U.call(e)?j(e.elements.img):e.data.orientation,e.options.enableZoom?V.call(e,!0):e._currentZoom=n,o.scale=e._currentZoom,t[R]=o.toString(),b(i,t),e.data.points.length?ye.call(e,e.data.points):be.call(e),z.call(e),A.call(e))}function V(e){var n=this,t=Math.max(n.options.minZoom,0)||0,i=n.options.maxZoom||1.5,r,o,s=n.elements.zoomer,u=parseFloat(s.value),d=n.elements.boundary.getBoundingClientRect(),f=$(n.elements.img,n.data.orientation),p=n.elements.viewport.getBoundingClientRect(),v,a;n.options.enforceBoundary&&(v=p.width/f.width,a=p.height/f.height,t=Math.max(v,a)),t>=i&&(i=t+1),s.min=W(t,4),s.max=W(i,4),!e&&(u<s.min||u>s.max)?O.call(n,u<s.min?s.min:s.max):e&&(o=Math.max(d.width/f.width,d.height/f.height),r=n.data.boundZoom!==null?n.data.boundZoom:o,O.call(n,r)),P(s)}function ye(e){if(e.length!==4)throw"Croppie - Invalid number of points supplied: "+e;var n=this,t=e[2]-e[0],i=n.elements.viewport.getBoundingClientRect(),r=n.elements.boundary.getBoundingClientRect(),o={left:i.left-r.left,top:i.top-r.top},s=i.width/t,u=e[1],d=e[0],f=-1*e[1]+o.top,p=-1*e[0]+o.left,v={};v[Z]=d+"px "+u+"px",v[R]=new x(p,f,s).toString(),b(n.elements.preview,v),O.call(n,s),n._currentZoom=s}function be(){var e=this,n=e.elements.preview.getBoundingClientRect(),t=e.elements.viewport.getBoundingClientRect(),i=e.elements.boundary.getBoundingClientRect(),r=t.left-i.left,o=t.top-i.top,s=r-(n.width-t.width)/2,u=o-(n.height-t.height)/2,d=new x(s,u,e._currentZoom);b(e.elements.preview,R,d.toString())}function xe(e){var n=this,t=n.elements.canvas,i=n.elements.img,r=t.getContext("2d");r.clearRect(0,0,t.width,t.height),t.width=i.width,t.height=i.height;var o=n.options.enableOrientation&&e||j(i);ee(t,i,o)}function G(e){var n=this,t=e.points,i=M(t[0]),r=M(t[1]),o=M(t[2]),s=M(t[3]),u=o-i,d=s-r,f=e.circle,p=document.createElement("canvas"),v=p.getContext("2d"),a=e.outputWidth||u,c=e.outputHeight||d;p.width=a,p.height=c,e.backgroundColor&&(v.fillStyle=e.backgroundColor,v.fillRect(0,0,a,c));var l=i,h=r,m=u,g=d,w=0,y=0,_=a,C=c;return i<0&&(l=0,w=Math.abs(i)/u*a),m+l>n._originalImageWidth&&(m=n._originalImageWidth-l,_=m/u*a),r<0&&(h=0,y=Math.abs(r)/d*c),g+h>n._originalImageHeight&&(g=n._originalImageHeight-h,C=g/d*c),v.drawImage(this.elements.preview,l,h,m,g,w,y,_,C),f&&(v.fillStyle="#fff",v.globalCompositeOperation="destination-in",v.beginPath(),v.arc(p.width/2,p.height/2,p.width/2,0,Math.PI*2,!0),v.closePath(),v.fill()),p}function Ce(e){var n=e.points,t=document.createElement("div"),i=document.createElement("img"),r=n[2]-n[0],o=n[3]-n[1];return E(t,"croppie-result"),t.appendChild(i),b(i,{left:-1*n[0]+"px",top:-1*n[1]+"px"}),i.src=e.url,b(t,{width:r+"px",height:o+"px"}),t}function Ee(e){return G.call(this,e).toDataURL(e.format,e.quality)}function _e(e){var n=this;return new Promise(function(t){G.call(n,e).toBlob(function(i){t(i)},e.format,e.quality)})}function Re(e){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(n){e.classList.add(n)}),this.elements.img.parentNode.replaceChild(e,this.elements.img),this.elements.preview=e),this.elements.img=e}function ne(e,n){var t=this,i,r=[],o=null,s=U.call(t);if(typeof e=="string")i=e,e={};else if(Array.isArray(e))r=e.slice();else{if(typeof e=="undefined"&&t.data.url)return q.call(t),T.call(t),null;i=e.url,r=e.points||[],o=typeof e.zoom=="undefined"?null:e.zoom}return t.data.bound=!1,t.data.url=i||t.data.url,t.data.boundZoom=o,ce(i,s).then(function(u){if(Re.call(t,u),r.length)t.options.relative&&(r=[r[0]*u.naturalWidth/100,r[1]*u.naturalHeight/100,r[2]*u.naturalWidth/100,r[3]*u.naturalHeight/100]);else{var d=$(u),f=t.elements.viewport.getBoundingClientRect(),p=f.width/f.height,v=d.width/d.height,a,c;v>p?(c=d.height,a=c*p):(a=d.width,c=d.height/p);var l=(d.width-a)/2,h=(d.height-c)/2,m=l+a,g=h+c;t.data.points=[l,h,m,g]}t.data.orientation=e.orientation||1,t.data.points=r.map(function(w){return parseFloat(w)}),t.options.useCanvas&&xe.call(t,t.data.orientation),q.call(t),T.call(t),n&&n()})}function W(e,n){return parseFloat(e).toFixed(n||0)}function ie(){var e=this,n=e.elements.preview.getBoundingClientRect(),t=e.elements.viewport.getBoundingClientRect(),i=t.left-n.left,r=t.top-n.top,o=(t.width-e.elements.viewport.offsetWidth)/2,s=(t.height-e.elements.viewport.offsetHeight)/2,u=i+e.elements.viewport.offsetWidth+o,d=r+e.elements.viewport.offsetHeight+s,f=e._currentZoom;(f===1/0||isNaN(f))&&(f=1);var p=e.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(p,i/f),r=Math.max(p,r/f),u=Math.max(p,u/f),d=Math.max(p,d/f),{points:[W(i),W(r),W(u),W(d)],zoom:f,orientation:e.data.orientation}}var Le={type:"canvas",format:"png",quality:1},Ze=["jpeg","webp","png"];function Se(e){var n=this,t=ie.call(n),i=Y(N(Le),N(e)),r=typeof e=="string"?e:i.type||"base64",o=i.size||"viewport",s=i.format,u=i.quality,d=i.backgroundColor,f=typeof i.circle=="boolean"?i.circle:n.options.viewport.type==="circle",p=n.elements.viewport.getBoundingClientRect(),v=p.width/p.height,a;return o==="viewport"?(t.outputWidth=p.width,t.outputHeight=p.height):typeof o=="object"&&(o.width&&o.height?(t.outputWidth=o.width,t.outputHeight=o.height):o.width?(t.outputWidth=o.width,t.outputHeight=o.width/v):o.height&&(t.outputWidth=o.height*v,t.outputHeight=o.height)),Ze.indexOf(s)>-1&&(t.format="image/"+s,t.quality=u),t.circle=f,t.url=n.data.url,t.backgroundColor=d,a=new Promise(function(c){switch(r.toLowerCase()){case"rawcanvas":c(G.call(n,t));break;case"canvas":case"base64":c(Ee.call(n,t));break;case"blob":_e.call(n,t).then(c);break;default:c(Ce.call(n,t));break}}),a}function Me(){q.call(this)}function We(e){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var n=this,t=n.elements.canvas;if(n.data.orientation=le(n.data.orientation,e),ee(t,n.elements.img,n.data.orientation),z.call(n,!0),V.call(n),Math.abs(e)/90%2==1){var i=n._originalImageHeight,r=n._originalImageWidth;n._originalImageWidth=i,n._originalImageHeight=r}}function Ie(){var e=this;e.element.removeChild(e.elements.boundary),ue(e.element,"croppie-container"),e.options.enableZoom&&e.element.removeChild(e.elements.zoomerWrap),delete e.elements}if(typeof window!="undefined"&&window.jQuery){var I=window.jQuery;I.fn.croppie=function(e){var n=typeof e;if(n==="string"){var t=Array.prototype.slice.call(arguments,1),i=I(this).data("croppie");return e==="get"?i.get():e==="result"?i.result.apply(i,t):e==="bind"?i.bind.apply(i,t):this.each(function(){var r=I(this).data("croppie");if(!!r){var o=r[e];if(I.isFunction(o))o.apply(r,t),e==="destroy"&&I(this).removeData("croppie");else throw"Croppie "+e+" method not found"}})}else return this.each(function(){var r=new L(this,e);r.$=I,I(this).data("croppie",r)})}}function L(e,n){if(e.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=e,this.options=Y(N(L.defaults),n),this.element.tagName.toLowerCase()==="img"){var t=this.element;E(t,"cr-original-image"),J(t,{"aria-hidden":"true",alt:""});var i=document.createElement("div");this.element.parentNode.appendChild(i),i.appendChild(t),this.element=i,this.options.url=this.options.url||t.src}if(fe.call(this),this.options.url){var r={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,ne.call(this,r)}}return L.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},L.globals={translate:"translate3d"},Y(L.prototype,{bind:function(e,n){return ne.call(this,e,n)},get:function(){var e=ie.call(this),n=e.points;return this.options.relative&&(n[0]/=this.elements.img.naturalWidth/100,n[1]/=this.elements.img.naturalHeight/100,n[2]/=this.elements.img.naturalWidth/100,n[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return Se.call(this,e)},refresh:function(){return Me.call(this)},setZoom:function(e){O.call(this,e),P(this.elements.zoomer)},rotate:function(e){We.call(this,e)},destroy:function(){return Ie.call(this)}}),L})})(K,K.exports);var Xe=K.exports;export{Xe as C};
